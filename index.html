<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AccessFirst ‚Äî Accessibility Demo (Developed by HaileGebriel)</title>

  <!-- Main stylesheet -->
  <link rel="stylesheet" href="style.css" />

  <!-- TensorFlow.js & Handsign required CDNs -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/syauqy/handsign-tensorflow@main/main.js" defer></script>

  <!-- Small inline pref initializer to avoid flicker -->
  <script>
    (function(){
      try {
        const p = JSON.parse(localStorage.getItem('af_prefs_v2')||'{}');
        if (p && p.contrast) document.documentElement.classList.add('high-contrast');
        if (p && p.fontSize === 'large') document.documentElement.style.fontSize='18px';
        if (p && p.fontSize === 'small') document.documentElement.style.fontSize='14px';
        if (p && p.reduceMotion) document.documentElement.classList.add('reduced-motion');
      } catch(e){}
    })();
  </script>
</head>
<body>
  <!-- Header -->
  <header class="site-header" role="banner">
    <div class="brand" aria-hidden="false">
      <h1 class="site-title">AccessFirst</h1>
      <p class="site-sub">Accessible experiences for Deaf & Blind ‚Äî Developed by HaileGebriel</p>
    </div>

    <nav class="nav" role="navigation" aria-label="Main Navigation">
      <ul class="nav-list">
        <li><button class="nav-btn" data-target="home" id="nav-home">Home</button></li>
        <li><button class="nav-btn" data-target="access-choice" id="nav-access">Accessibility</button></li>
        <li><button class="nav-btn" id="nav-login" data-modal="login-modal">Login</button></li>
        <li><button class="nav-btn" id="nav-signup" data-modal="signup-modal">Sign Up</button></li>
        <li><a class="nav-link donate" id="nav-donate" href="https://www.gofundme.com/f/Mekedonia-Charity-help-build-home-for-the-homeless" target="_blank" rel="noopener">Donate</a></li>
        <li><button class="nav-btn" data-target="about" id="nav-about">About</button></li>
      </ul>
    </nav>

    <div class="prefs" role="region" aria-label="Preferences">
      <label class="pref">
        <input id="contrast-toggle" type="checkbox" aria-label="Toggle high contrast" />
        <span>Contrast</span>
      </label>

      <label class="pref">
        <span class="pref-label">Font</span>
        <select id="font-size" aria-label="Font size">
          <option value="small">A‚àí</option>
          <option value="medium" selected>A</option>
          <option value="large">A+</option>
        </select>
      </label>

      <label class="pref">
        <input id="reduce-motion" type="checkbox" aria-label="Reduce motion" />
        <span>Reduce motion</span>
      </label>

      <label class="pref">
        <input id="demo-mode" type="checkbox" aria-label="Demo mode" />
        <span>Demo</span>
      </label>
    </div>
  </header>

  <!-- Main content -->
  <main id="main" class="main" role="main">
    <!-- HOME -->
    <section id="home" class="page page--active" aria-labelledby="home-title">
      <div class="hero glass">
        <div class="hero-left">
          <h2 id="home-title">Welcome to AccessFirst</h2>
          <p class="lead">An accessibility-first demo for Deaf & Blind people. Explore voice, sign, and preference features ‚Äî all in the browser.</p>

          <div class="cta-row" role="group" aria-label="Primary calls to action">
            <button class="btn btn-primary" id="cta-get-started" data-target="access-choice">Get Started</button>
            <button class="btn btn-outline" id="cta-login" data-modal="login-modal">Login</button>
            <button class="btn btn-ghost" id="cta-signup" data-modal="signup-modal">Sign Up</button>
            <a class="btn btn-donate" id="cta-donate" href="https://www.gofundme.com/f/Mekedonia-Charity-help-build-home-for-the-homeless" target="_blank" rel="noopener">Donate to Mekedonia</a>
          </div>

          <div class="third-row small muted">
            <p>Local accounts are stored securely in your browser. Speech features use the Web Speech API. Handsign uses TensorFlow.js when available.</p>
          </div>
        </div>

        <aside class="hero-right glass" aria-labelledby="tts-title">
          <h3 id="tts-title">Text-to-Speech</h3>
          <p class="muted">Type text and press Speak. Works with keyboard and screen readers.</p>

          <label for="home-tts-input" class="visually-hidden">Text to speak</label>
          <textarea id="home-tts-input" placeholder="Type something to speak..." rows="5" aria-label="Text to speech input"></textarea>
          <div class="tool-actions">
            <button class="btn btn-primary" id="home-tts-speak">Speak</button>
            <button class="btn btn-subtle" id="home-tts-stop">Stop</button>
            <button class="btn btn-subtle" id="home-tts-clear">Clear</button>
          </div>
        </aside>
      </div>

      <section class="features glass-panel" aria-labelledby="features-title">
        <h3 id="features-title">Features</h3>
        <ul>
          <li>Voice-first flow for blind users (Speech-to-Text & Text-to-Speech)</li>
          <li>Visual-first sign flow for deaf users with camera detection (TensorFlow.js / Handsign)</li>
          <li>High-contrast, font size, reduced motion controls</li>
          <li>Local authentication (secure hashed passwords), simulated third-party login</li>
          <li>Donate to Mekedonia via GoFundMe ‚Äî owner notified</li>
        </ul>
      </section>
    </section>

    <!-- ACCESSIBILITY CHOICE -->
    <section id="access-choice" class="page" aria-labelledby="access-title" hidden>
      <div class="panel glass" role="region">
        <button class="btn btn-back" data-target="home">‚Üê Back</button>
        <h2 id="access-title">Choose Accessibility Flow</h2>
        <p class="lead">Pick the experience that best suits your needs.</p>

        <div class="choices" role="list">
          <button class="choice" id="flow-blind" data-target="blind-flow" aria-describedby="blind-desc" title="Blind mode ‚Äî voice-first" role="listitem">
            <span class="emoji">üëÅÔ∏è</span>
            <span>Blind</span>
            <small id="blind-desc">Voice-first interface</small>
          </button>

          <button class="choice" id="flow-deaf" data-target="deaf-flow" aria-describedby="deaf-desc" title="Deaf mode ‚Äî visual-first" role="listitem">
            <span class="emoji">ü§ü</span>
            <span>Deaf</span>
            <small id="deaf-desc">Sign language & camera detection</small>
          </button>
        </div>
      </div>
    </section>

    <!-- BLIND FLOW -->
    <section id="blind-flow" class="page" aria-labelledby="blind-title" hidden>
      <div class="panel glass">
        <button class="btn btn-back" data-target="access-choice">‚Üê Back</button>
        <h2 id="blind-title">Blind Mode</h2>
        <p class="lead">Voice-enabled UI. Speak or type ‚Äî everything can speak back when voice feedback enabled.</p>

        <div class="split">
          <div class="tool">
            <h3>Speech-to-Text</h3>
            <p class="muted">Press Start Listening and speak. Recognized text will appear below.</p>
            <label for="blind-stt-output" class="visually-hidden">Recognized speech</label>
            <textarea id="blind-stt-output" rows="5" placeholder="Recognized text..." aria-label="Speech to text output"></textarea>
            <div class="tool-actions">
              <button class="btn" id="blind-stt-start">Start Listening</button>
              <button class="btn btn-subtle" id="blind-stt-stop">Stop</button>
              <button class="btn btn-subtle" id="blind-stt-copy">Copy</button>
            </div>
          </div>

          <div class="tool">
            <h3>Text-to-Speech</h3>
            <p class="muted">Type text and press Speak below.</p>

            <div class="voice-toggle-row" style="display:flex;align-items:center;gap:0.5rem;margin-bottom:0.6rem;">
              <label for="blind-voice-toggle" class="muted">Voice feedback</label>
              <button id="blind-voice-toggle" class="btn btn-subtle" aria-pressed="false">Enable Voice Feedback</button>
            </div>

            <label for="blind-tts-input" class="visually-hidden">Text to speak</label>
            <textarea id="blind-tts-input" rows="5" placeholder="Type to speak..." aria-label="Text to speech input"></textarea>
            <div class="tool-actions">
              <button class="btn" id="blind-tts-speak">Speak</button>
              <button class="btn btn-subtle" id="blind-tts-stop">Stop</button>
              <button class="btn btn-subtle" id="blind-tts-clear">Clear</button>
            </div>
          </div>
        </div>

        <div class="history glass-panel" aria-live="polite">
          <h4>Interaction History</h4>
          <ul id="history-blind"></ul>
        </div>
      </div>
    </section>

    <!-- DEAF FLOW -->
    <section id="deaf-flow" class="page" aria-labelledby="deaf-title" hidden>
      <div class="panel glass">
        <button class="btn btn-back" data-target="access-choice">‚Üê Back</button>
        <h2 id="deaf-title">Deaf Mode</h2>
        <p class="lead">Visual-first. Use the sign palette or camera detection to create phrases.</p>

        <div class="split">
          <div class="tool">
            <h3>Sign-to-Speech</h3>
            <p class="muted">Click signs to build a phrase. Press Speak to read it aloud.</p>

            <div id="sign-palette" class="sign-palette" role="list" aria-label="Sign palette">
              <!-- populated by JS -->
            </div>

            <div class="assembled glass" aria-live="polite">
              <div class="assembled-label">Phrase:</div>
              <div id="assembled-phrase" class="assembled-phrase"></div>
            </div>

            <div class="tool-actions">
              <button class="btn" id="s2s-speak">Speak Phrase</button>
              <button class="btn btn-subtle" id="s2s-clear">Clear Phrase</button>
            </div>
          </div>

          <div class="tool">
            <h3>Speech-to-Sign (Camera detection)</h3>
            <p class="muted">Start the camera and Handsign model will attempt to classify hand signs in real-time. You may also speak and map words to sign placeholders.</p>

            <div style="display:flex;gap:0.5rem;margin-bottom:0.6rem;">
              <button class="btn" id="deaf-stt-start">Speech-to-Sign (Start)</button>
              <button class="btn btn-subtle" id="deaf-stt-stop">Stop</button>
            </div>

            <label for="deaf-stt-output" class="visually-hidden">Recognized speech</label>
            <textarea id="deaf-stt-output" rows="3" placeholder="Recognized speech will appear here" aria-label="Speech to sign recognized text"></textarea>

            <div id="deaf-stt-signs" class="deaf-stt-signs" aria-live="polite" style="margin-top:0.6rem;"></div>

            <div class="camera-wrap" style="margin-top:0.8rem;">
              <video id="camera-video" autoplay playsinline muted></video>
              <canvas id="camera-canvas" aria-hidden="true"></canvas>
            </div>

            <div id="detected-sign" class="detected-sign" aria-live="polite">No sign detected</div>

            <div class="tool-actions">
              <button class="btn" id="start-camera">Start Camera</button>
              <button class="btn btn-subtle" id="stop-camera">Stop Camera</button>
              <button class="btn btn-subtle" id="speak-detected">Speak Detected</button>
            </div>

            <div id="camera-status" class="muted small">Status: idle</div>
          </div>
        </div>

        <div class="history glass-panel" aria-live="polite">
          <h4>Interaction History</h4>
          <ul id="history-deaf"></ul>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about" class="page" aria-labelledby="about-title" hidden>
      <div class="panel glass-panel">
        <button class="btn btn-back" data-target="home">‚Üê Back</button>
        <h2 id="about-title">About AccessFirst</h2>

        <p>This website demonstrates accessibility-first front-end experiences for people who are Blind or Deaf. It uses browser-native speech APIs for Text-to-Speech and Speech-to-Text and integrates TensorFlow.js / Handsign for camera-based hand-sign detection when available.</p>

        <h3>Mekedonia Charity</h3>
        <p>Mekedonia provides care and shelter for homeless people. Donations from this site go to Mekedonia via GoFundMe. The site will notify the owner when visitors click Donate so Mekedonia knows the referral source.</p>

        <h3>Target Audience</h3>
        <p>Blind users receive voice-first interactions and voice feedback; Deaf users receive visual-first sign representations and camera-assisted detection to help communicate.</p>

        <footer class="about-footer">
          <p>Developed by HaileGebriel</p>
        </footer>
      </div>
    </section>
  </main>

  <!-- Login Modal -->
  <dialog id="login-modal" class="modal" aria-labelledby="login-modal-title">
    <form id="login-form" class="modal-form" method="dialog" autocomplete="on">
      <h3 id="login-modal-title">Welcome back</h3>
      <p class="muted">Sign in to your local AccessFirst account.</p>

      <label for="login-email">Email</label>
      <input id="login-email" type="email" required autocomplete="email" placeholder="you@example.com"/>

      <label for="login-password">Password</label>
      <input id="login-password" type="password" required autocomplete="current-password" placeholder="Your password"/>

      <div class="social-row" role="group" aria-label="Third party logins">
        <button type="button" class="social google" id="login-google">Continue with Google</button>
        <button type="button" class="social ms" id="login-microsoft">Continue with Microsoft</button>
      </div>

      <div class="modal-actions">
        <button class="btn btn-primary" type="submit" id="login-submit">Sign in</button>
        <button class="btn btn-subtle" type="button" id="login-close">Cancel</button>
      </div>
    </form>
  </dialog>

  <!-- Signup Modal -->
  <dialog id="signup-modal" class="modal" aria-labelledby="signup-modal-title">
    <form id="signup-form" class="modal-form" method="dialog" autocomplete="on">
      <h3 id="signup-modal-title">Create account</h3>
      <p class="muted">Create a secure local account ‚Äî the site will notify the owner when a new account is created (mailto fallback).</p>

      <label for="signup-username">Username</label>
      <input id="signup-username" type="text" required minlength="2" placeholder="Your display name"/>

      <label for="signup-email">Email</label>
      <input id="signup-email" type="email" required placeholder="you@example.com" autocomplete="email"/>

      <label for="signup-password">Password</label>
      <input id="signup-password" type="password" required placeholder="Choose a strong password" autocomplete="new-password"/>
      <meter id="pwd-strength" min="0" max="4" low="2" high="3" optimum="4" value="0" aria-hidden="true"></meter>
      <div id="pwd-feedback" class="muted small">Password strength: </div>

      <fieldset class="prefs-fieldset">
        <legend>Preferences</legend>
        <label><input id="signup-contrast" type="checkbox" /> High contrast</label>
        <label><input id="signup-reduce" type="checkbox" /> Reduce motion</label>
        <label>Font size
          <select id="signup-font">
            <option value="medium" selected>Medium</option>
            <option value="large">Large</option>
            <option value="small">Small</option>
          </select>
        </label>
      </fieldset>

      <div class="social-row">
        <button type="button" class="social google" id="signup-google">Sign up with Google</button>
        <button type="button" class="social ms" id="signup-microsoft">Sign up with Microsoft</button>
      </div>

      <div class="modal-actions">
        <button class="btn btn-primary" type="submit" id="signup-submit">Create account</button>
        <button class="btn btn-subtle" type="button" id="signup-close">Cancel</button>
      </div>
    </form>
  </dialog>

  <!-- SR Live region -->
  <div id="live" aria-live="polite" class="visually-hidden"></div>

  <!-- Footer -->
  <footer class="site-footer">
    <div>¬© <span id="year"></span> AccessFirst ‚Äî Developed by HaileGebriel</div>
  </footer>

  <!-- Main script -->
  <script src="script.js" defer></script>
</body>
</html>
