<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AccessFirst ‚Äî Accessible Demo (Developed by HaileGebriel)</title>

  <!-- Stylesheet -->
  <link rel="stylesheet" href="style.css" />

  <!-- TensorFlow.js & Handsign model scripts (CDNs) -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.18.0/dist/tf.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/syauqy/handsign-tensorflow@main/main.js" defer></script>

  <!-- Inline language and preference initializer (prevents flash of default) -->
  <script>
    (function(){
      try {
        const prefs = JSON.parse(localStorage.getItem('af_prefs') || '{}');
        if (prefs && prefs.contrast) document.documentElement.classList.add('high-contrast');
        if (prefs && prefs.fontSize === 'large') document.documentElement.style.fontSize = '18px';
        if (prefs && prefs.fontSize === 'small') document.documentElement.style.fontSize = '14px';
        if (prefs && prefs.reduceMotion) document.documentElement.classList.add('reduced-motion');
      } catch(e){}
    })();
  </script>
</head>
<body>
  <!-- Skip to main content -->
  <a class="skip-link" href="#main">Skip to main content</a>

  <!-- Header -->
  <header class="site-header" role="banner">
    <div class="brand">
      <h1 id="brand-title">AccessFirst</h1>
      <p class="site-tagline visually-hidden">Accessible demo ‚Äî Developed by HaileGebriel</p>
    </div>

    <nav class="primary-nav" role="navigation" aria-label="Primary Navigation">
      <ul>
        <li><button class="nav-btn" data-target="home" id="nav-home">Home</button></li>
        <li><button class="nav-btn" data-target="access-choice" id="nav-access">Accessibility</button></li>
        <li><button class="nav-btn" data-modal="login" id="nav-login">Login</button></li>
        <li><button class="nav-btn" data-modal="signup" id="nav-signup">Sign Up</button></li>
        <li><button class="nav-btn" id="nav-guest">Continue as Guest</button></li>
        <li><a class="donate" id="donate-link" href="https://gofundme.com/placeholder" target="_blank" rel="noopener noreferrer">Donate</a></li>
      </ul>
    </nav>

    <div class="header-controls" role="region" aria-label="Preferences">
      <label for="contrast-toggle" class="visually-hidden">High contrast</label>
      <input id="contrast-toggle" type="checkbox" aria-label="Toggle high contrast" />

      <label for="font-size" class="visually-hidden">Font size</label>
      <select id="font-size" aria-label="Select font size">
        <option value="small">Small</option>
        <option value="medium" selected>Medium</option>
        <option value="large">Large</option>
      </select>

      <label for="reduced-motion" class="visually-hidden">Reduce motion</label>
      <input id="reduced-motion" type="checkbox" aria-label="Toggle reduced motion" />

      <label for="demo-mode" class="visually-hidden">Demo mode</label>
      <input id="demo-mode" type="checkbox" aria-label="Toggle demo mode" />
    </div>
  </header>

  <!-- Main content -->
  <main id="main" class="container" role="main" tabindex="-1">
    <!-- HOME -->
    <section id="home" class="page page-active" aria-labelledby="home-heading">
      <div class="hero glass">
        <div class="hero-copy">
          <h2 id="home-heading">Welcome to AccessFirst</h2>
          <p class="lead">An accessibility-first interactive demo. Developed by HaileGebriel.</p>

          <div class="cta-row">
            <button class="cta btn-primary" id="cta-start" data-target="access-choice">Get Started</button>
            <button class="cta btn-ghost" id="cta-guest">Continue as Guest</button>
            <a class="cta btn-donate" id="cta-donate" href="https://gofundme.com/placeholder" target="_blank" rel="noopener noreferrer">Donate</a>
          </div>
        </div>

        <div class="hero-panel glass-inner" aria-hidden="false">
          <h3>Text-to-Speech</h3>
          <p class="muted">Type text and have it spoken aloud. Works well with keyboard & screen readers.</p>

          <label for="tts-area" class="visually-hidden">Text to speak</label>
          <textarea id="tts-area" rows="4" placeholder="Type text to be spoken"></textarea>

          <div class="tool-actions">
            <button class="btn" id="tts-speak">Speak</button>
            <button class="btn subtle" id="tts-stop">Stop</button>
            <button class="btn subtle" id="tts-clear">Clear</button>
          </div>
        </div>
      </div>

      <div class="intro glass-panel">
        <h3>About</h3>
        <p>Accessible design, keyboard navigation, speech features, and sign-language demo. <strong>Developed by HaileGebriel</strong>.</p>
      </div>
    </section>

    <!-- ACCESSIBILITY CHOICE -->
    <section id="access-choice" class="page" aria-labelledby="access-heading" hidden>
      <div class="panel glass-inner">
        <button class="btn back" data-target="home">‚Üê Back</button>
        <h2 id="access-heading">Choose accessibility flow</h2>
        <p class="lead">Pick the experience that best matches your needs.</p>

        <div class="choices">
          <button class="choice large" id="choose-blind" data-target="blind-flow" aria-describedby="blind-desc">
            <span class="emoji">üëÅÔ∏è</span>
            <span>Blind</span>
            <small id="blind-desc">Voice-first experience</small>
          </button>

          <button class="choice large" id="choose-deaf" data-target="deaf-flow" aria-describedby="deaf-desc">
            <span class="emoji">ü§ü</span>
            <span>Deaf</span>
            <small id="deaf-desc">Visual-first sign language</small>
          </button>
        </div>
      </div>
    </section>

    <!-- BLIND FLOW -->
    <section id="blind-flow" class="page" aria-labelledby="blind-heading" hidden>
      <div class="panel glass-inner">
        <button class="btn back" data-target="access-choice">‚Üê Back</button>
        <h2 id="blind-heading">Blind Mode</h2>
        <p class="lead">Voice-enabled UI. Use Speech-to-Text or Text-to-Speech.</p>

        <div class="blind-tools">
          <div class="tool">
            <h3>Speech-to-Text</h3>
            <p class="muted">Click listen and speak ‚Äî recognized text appears below.</p>
            <textarea id="stt-output" rows="4" placeholder="Recognized speech will appear here" aria-label="Speech to text output"></textarea>
            <div class="tool-actions">
              <button class="btn" id="stt-start">Start Listening</button>
              <button class="btn subtle" id="stt-stop">Stop</button>
              <button class="btn subtle" id="stt-copy">Copy</button>
            </div>
          </div>

          <div class="tool">
            <h3>Text-to-Speech</h3>
            <p class="muted">Type text and speak it aloud.</p>
            <textarea id="blind-tts" rows="4" placeholder="Type to speak" aria-label="Text to speech input"></textarea>
            <div class="tool-actions">
              <button class="btn" id="blind-tts-speak">Speak</button>
              <button class="btn subtle" id="blind-tts-stop">Stop</button>
              <button class="btn subtle" id="blind-tts-clear">Clear</button>
            </div>
          </div>
        </div>

        <div class="history-panel">
          <h4>Interaction History</h4>
          <ul id="history-blind" aria-live="polite"></ul>
        </div>
      </div>
    </section>

    <!-- DEAF FLOW -->
    <section id="deaf-flow" class="page" aria-labelledby="deaf-heading" hidden>
      <div class="panel glass-inner">
        <button class="btn back" data-target="access-choice">‚Üê Back</button>
        <h2 id="deaf-heading">Deaf Mode</h2>
        <p class="lead">Sign language tools. Real-time camera detection via Handsign (TensorFlow.js).</p>

        <div class="deaf-grid">
          <div class="tool">
            <h3>Sign-to-Speech</h3>
            <p class="muted">Select signs to build a phrase and have it spoken.</p>
            <div id="sign-palette" class="sign-palette" role="list" aria-label="Sign palette">
              <!-- buttons populated from JS -->
            </div>

            <div class="assembled">
              <div class="assembled-label">Phrase:</div>
              <div id="assembled-phrase" class="assembled-phrase" aria-live="polite"></div>
            </div>

            <div class="tool-actions">
              <button class="btn" id="s2s-speak">Speak Phrase</button>
              <button class="btn subtle" id="s2s-clear">Clear Phrase</button>
            </div>
          </div>

          <div class="tool">
            <h3>Speech-to-Sign (Camera)</h3>
            <p class="muted">Speak or use the camera for real-time sign detection.</p>

            <div class="camera-wrap">
              <video id="camera-video" autoplay playsinline muted></video>
              <canvas id="camera-canvas" aria-hidden="true"></canvas>
            </div>

            <div id="detected-sign" class="detected-sign" aria-live="polite">No sign detected</div>

            <div class="tool-actions">
              <button class="btn" id="start-detection">Start Camera Detection</button>
              <button class="btn subtle" id="stop-detection">Stop Detection</button>
              <button class="btn subtle" id="speak-detected">Speak Detected</button>
            </div>

            <div id="camera-status" class="muted small">Camera not started</div>
          </div>
        </div>

        <div class="history-panel">
          <h4>Interaction History</h4>
          <ul id="history-deaf" aria-live="polite"></ul>
        </div>
      </div>
    </section>
  </main>

  <!-- Login Modal -->
  <dialog id="login-modal" aria-labelledby="login-title">
    <form method="dialog" class="modal-form" id="login-form">
      <h3 id="login-title">Login</h3>
      <p class="muted">Create a local profile stored in your browser. No backend.</p>

      <label for="login-username">Username</label>
      <input id="login-username" type="text" required minlength="2" />

      <label for="login-type">User Type</label>
      <select id="login-type">
        <option value="none">None</option>
        <option value="blind">Blind</option>
        <option value="deaf">Deaf</option>
      </select>

      <div class="modal-actions">
        <button class="btn" type="submit">Login</button>
        <button class="btn subtle" id="login-cancel" type="button">Cancel</button>
      </div>
    </form>
  </dialog>

  <!-- Signup Modal -->
  <dialog id="signup-modal" aria-labelledby="signup-title">
    <form method="dialog" class="modal-form" id="signup-form">
      <h3 id="signup-title">Sign Up</h3>
      <p class="muted">Create a local profile with preferences.</p>

      <label for="signup-username">Username</label>
      <input id="signup-username" type="text" required minlength="2" />

      <label for="signup-type">User Type</label>
      <select id="signup-type">
        <option value="blind">Blind</option>
        <option value="deaf">Deaf</option>
        <option value="none">None</option>
      </select>

      <fieldset>
        <legend>UI Preferences</legend>
        <label><input type="checkbox" id="signup-contrast" /> High contrast</label>
        <label><input type="checkbox" id="signup-reduced" /> Reduce motion</label>
        <label for="signup-font">Font size</label>
        <select id="signup-font"><option value="medium">Medium</option><option value="large">Large</option></select>
      </fieldset>

      <div class="modal-actions">
        <button class="btn" type="submit">Create Profile</button>
        <button class="btn subtle" id="signup-cancel" type="button">Cancel</button>
      </div>
    </form>
  </dialog>

  <!-- Global live region for screen reader announcements -->
  <div id="sr-live" class="visually-hidden" aria-live="polite" aria-atomic="true"></div>

  <!-- Footer -->
  <footer class="site-footer" role="contentinfo">
    <div>¬© <span id="year"></span> AccessFirst ‚Äî Developed by HaileGebriel</div>
  </footer>

  <!-- Main script -->
  <script src="script.js" defer></script>
</body>
</html>
